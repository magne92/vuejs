<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script> <!-- vue js -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Vue.js App Root -->
    <div id="app">
        <h1>GARN</h1>
        <button @click="newYarn">Nytt garn</button>
        <div v-if="viewAllYarn" id="yarn_content">
            <div @click="changeYarn(yarn.id)" class="yarn" v-if='contentLoaded' v-for="yarn in yarn_data" :key='yarn.id'>
                <div class="yarn_title" >
                    <p>{{yarn.type}}</p>
                    <p>Pinne: {{ yarn.stick }}</p>
                    <p>Fasthet: {{ yarn.thickness }}</p>
                    <p>Merke: {{ yarn.brand }}</p>
                </div>
                <div class="yarn_entities"><span v-for=" ent in yarn.entities" :key="ent.id">{{ ent.color}} {{ ent.amount}}</span></div>
            </div> 
        </div>
        <div class="activeYarn" v-if="viewEditYarn">
            <button @click="return_to_viewAllYarn">Tilbake</button><br>
            <div class="yarn_title_active" >
                <p>{{activeYarn.type}}</p>
                <p>Pinne: {{ activeYarn.stick }}</p>
                <p>Fasthet: {{ activeYarn.thickness }}</p>
                <p>Merke: {{ activeYarn.brand }}</p>
            </div>
            <div class="yarn_entities_active"><span v-for=" ent in activeYarn.entities" :key="ent.id">{{ ent.color}} {{ ent.amount}}</span></div>
        </div>
        <div class="newYarn" v-if="viewNewYarn">
            <label for="type">Type</label>
            <input type="text" name="type"><br>
            <label for="stick">Pinne</label>
            <input type="text" name="stick"><br>
            <label for="thickness">Fasthet</label>
            <input type="text" name="thickness"><br>
            <label for="brand">Merke</label>
            <input type="text" name="brand"><br>
            <button @click="addYarn">Legg til</button>
        </div>

    </div>

    <!-- Your Vue.js Script -->
    <script type="module" >
          // Create a Vue application
        //import MyComponent from './src/MyComponent.vue';


        const app = Vue.createApp({
        
        // Define your data properties
        data() {
            return {
                contentLoaded: false,
                viewAllYarn: true,
                viewEditYarn: false,
                viewNewYarn: false,
                viewing_YarnID: NaN,
                message: 'Hello Vue!',
                content: 'this is content',
                yarn_data: NaN
            }
        },

        methods: {
        
        fetchData() {
        fetch('/data')
            .then(response => {
                // Check if the request was successful
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                this.message = data.message;
                this.yarn_data = data
                console.log(this.yarn_data)
                this.contentLoaded = true
            })
            .catch(error => {
                this.message = 'Error: ' + error.message;
            });
        },

        toggleContent() {
            this.showContent = !this.showContent // set showcontent to opposite 
        },

        return_to_viewAllYarn(){
            this.viewEditYarn = false
            this.viewAllYarn = true  
        },

        changeYarn(id) {
            console.log(id)
            this.viewing_YarnID = id
            this.viewEditYarn = true
            this.viewAllYarn = false
            this.activeYarn = this.yarn_data[id]
            console.log(this.activeYarn)
        },

        newYarn() {
            this.viewEditYarn = false
            this.viewAllYarn = false
            this.viewNewYarn = true
        },
        addYarn(){
            
        }

        },
        mounted: function() {
            this.fetchData()
            console.log("loaded data")
            }
        });

        // Mount your application to the DOM element
        app.mount('#app');
    </script>

</body>
</html>